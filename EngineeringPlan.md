è¿™æ˜¯ä¸€ä¸ªéå¸¸æ£’çš„é‡Œç¨‹ç¢‘ï¼ä½ å·²ç»å®Œæˆäº†â€œè¡Œèµ°çš„éª¨æ¶ï¼ˆWalking Skeletonï¼‰â€ï¼Œæ¥ä¸‹æ¥çš„å·¥ä½œå°±æ˜¯å¾€éª¨æ¶ä¸Šå¡«è‚‰ã€‚

ä¸ºäº†ç¡®ä¿ä½ ï¼ˆä»¥åŠä¹‹åååŠ©ä½ çš„ä»»ä½• AIï¼‰èƒ½æ— ç¼è¡”æ¥ï¼Œæˆ‘ä¸ºä½ åˆ¶å®šäº†è¿™ä»½\*\*â€œMori å·¥ç¨‹å®æ–½è“å›¾ (Mori Engineering Blueprint)â€\*\*ã€‚

è¿™ä»½æ–‡æ¡£é‡‡ç”¨äº†**é«˜ä¸Šä¸‹æ–‡ã€ä½æ­§ä¹‰**çš„æ ¼å¼ç¼–å†™ã€‚åœ¨æ¥ä¸‹æ¥çš„å¼€å‘ä¸­ï¼Œä½ å¯ä»¥ç›´æ¥æŠŠè¿™ä»½æ–‡æ¡£çš„å¯¹åº”éƒ¨åˆ†å‘ç»™ AIï¼Œè¦æ±‚å®ƒç”Ÿæˆä»£ç ã€‚

-----

# ğŸš€ Mori (MVP) å·¥ç¨‹å®æ–½è“å›¾

## 0\. é¡¹ç›®ä¸Šä¸‹æ–‡ (Context for AI)

  * **é¡¹ç›®åç§°:** Mori (åŸºäº Galaxy/Star æ‹“æ‰‘ç»“æ„çš„æ•°å­—èŠ±å›­)
  * **æ ¸å¿ƒéšå–»:** æ‰€æœ‰çš„æƒ³æ³•ï¼ˆNodesï¼‰éƒ½æ˜¯å›´ç»•æ ¸å¿ƒï¼ˆAvatarï¼‰æ—‹è½¬çš„å«æ˜Ÿã€‚
  * **æŠ€æœ¯æ ˆ:**
      * **Frontend:** Vue 3 (Script Setup), Vite, TailwindCSS (å¯é€‰), **Vue Flow (æ ¸å¿ƒç”»å¸ƒåº“)**ã€‚
      * **Backend:** Node.js + Express (Monolith æ¶æ„ï¼Œæ‰˜ç®¡é™æ€å‰ç«¯)ã€‚
      * **Database:** MongoDB Atlas (Mongoose ORM)ã€‚
      * **Media:** Cloudinary (Unsigned Upload)ã€‚
      * **Deploy:** Docker + Render (Web Service)ã€‚
  * **å½“å‰è¿›åº¦:** åŸºç¡€è„šæ‰‹æ¶å·²è·‘é€šï¼ŒDocker éƒ¨ç½²æˆåŠŸï¼ŒAtlas/Cloudinary å·²é…ç½®ã€‚

-----

## Phase 1: å‰ç«¯ç”»å¸ƒæ ¸å¿ƒ (The Visual Core)

**ç›®æ ‡:** å®ç°åŸºäº Vue Flow çš„äº¤äº’å¼ç”»å¸ƒï¼Œå®Œæˆâ€œæ˜Ÿç³»â€å¸ƒå±€é€»è¾‘ã€‚

### 1.1 å¼•å…¥ Vue Flow

  * **Action:** å®‰è£… `@vue-flow/core` å’Œ `@vue-flow/background`ã€‚
  * **é…ç½®:**
      * ç¦ç”¨é»˜è®¤çš„è¿çº¿äº¤äº’ï¼ˆç”¨æˆ·ä¸èƒ½æ‰‹åŠ¨è¿çº¿ï¼‰ã€‚
      * å¯ç”¨ `pan` (å¹³ç§») å’Œ `zoom` (ç¼©æ”¾)ã€‚
      * éšè—é»˜è®¤çš„ `Controls` å’Œ `Minimap` (ä¿æŒç•Œé¢æç®€ï¼ŒMVP åæœŸå†åŠ )ã€‚

### 1.2 è‡ªå®šä¹‰èŠ‚ç‚¹ (Custom Node Component)

  * **ç»„ä»¶å:** `MoriNode.vue`
  * **åŠŸèƒ½:**
      * **å±•ç¤º:** æ¸²æŸ“æ–‡æœ¬å†…å®¹å’Œå›¾ç‰‡ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚
      * **æ ·å¼:** å¿…é¡»å»â€œå·¥ä¸šåŒ–â€ã€‚ç§»é™¤æ ‡å‡†è¾¹æ¡†ï¼Œä½¿ç”¨åœ†è§’ã€é˜´å½±ã€æ‰‹å†™å­—ä½“ã€‚
      * **Handle (è¿æ¥ç‚¹):** è®¾ä¸º `opacity: 0` æˆ–é€šè¿‡ CSS éšè—ï¼ˆæˆ‘ä»¬ä¸éœ€è¦ç”¨æˆ·çœ‹åˆ°è¿æ¥ç‚¹ï¼Œå› ä¸ºè¿çº¿æ˜¯è‡ªåŠ¨çš„ï¼‰ã€‚
  * **æ•°æ®ç»“æ„ (Props):**
    ```typescript
    interface NodeData {
      label: string;      // æ–‡æœ¬å†…å®¹
      image?: string;     // å›¾ç‰‡ URL (Cloudinary)
      isCore?: boolean;   // æ˜¯å¦æ˜¯æ ¸å¿ƒå¤´åƒèŠ‚ç‚¹
    }
    ```

### 1.3 æ ¸å¿ƒäº¤äº’é€»è¾‘ (The Gravity Logic)

  * **åˆå§‹åŒ–:** ç”»å¸ƒåŠ è½½æ—¶ï¼Œè‡ªåŠ¨åœ¨ä¸­å¿ƒ `(0, 0)` ç”Ÿæˆä¸€ä¸ª **Core Node** (ç”¨æˆ·å¤´åƒ)ã€‚
  * **æ·»åŠ èŠ‚ç‚¹ (Add Idea):**
      * ç‚¹å‡»â€œæ·»åŠ â€æŒ‰é’®ã€‚
      * **ä½ç½®ç®—æ³•:** åœ¨æ ¸å¿ƒèŠ‚ç‚¹å‘¨å›´éšæœºåŠå¾„ R çš„åœ†å‘¨ä¸Šç”Ÿæˆæ–°èŠ‚ç‚¹åæ ‡ `(x, y)`ã€‚
      * **è‡ªåŠ¨è¿çº¿:** åŒæ­¥ç”Ÿæˆä¸€æ¡ Edgeï¼Œ`source: CORE_ID`, `target: NEW_NODE_ID`ã€‚
      * **æ ·å¼:** Edge éœ€è¦è®¾ç½®ä¸ºè™šçº¿æˆ–æµ…è‰²ï¼Œæ¨¡ä»¿â€œå¼•åŠ›çº¿â€ã€‚

-----

## Phase 2: åç«¯ä¸æ•°æ®æŒä¹…åŒ– (The Memory)

**ç›®æ ‡:** å®ç°æ•´æ¿æ•°æ®çš„å­˜å–ï¼Œç¡®ä¿åˆ·æ–°é¡µé¢ä¸ä¸¢å¤±ã€‚

### 2.1 Mongoose Schema è®¾è®¡

ä¸ºäº† MVP æé€Ÿå¼€å‘ï¼Œæˆ‘ä»¬é‡‡ç”¨ **â€œå¿«ç…§å¼å­˜å‚¨â€** (Document per User/Board)ã€‚

  * **Model:** `Universe`
  * **Schema å®šä¹‰:**
    ```javascript
    const UniverseSchema = new mongoose.Schema({
      userId: { type: String, default: 'demo-user', unique: true }, // MVP å†™æ­»
      nodes: { type: Array, default: [] }, // ç›´æ¥å­˜ Vue Flow çš„ nodes æ•°ç»„
      edges: { type: Array, default: [] }, // ç›´æ¥å­˜ Vue Flow çš„ edges æ•°ç»„
      lastUpdated: { type: Date, default: Date.now }
    });
    ```

### 2.2 API æ¥å£

  * `GET /api/universe`: è·å–å½“å‰ç”¨æˆ·çš„ nodes å’Œ edgesã€‚å¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›åˆå§‹åŒ–çš„â€œåªæœ‰æ ¸å¿ƒå¤´åƒâ€çš„æ•°æ®ã€‚
  * `POST /api/universe`: æ¥æ”¶å®Œæ•´çš„ `{ nodes, edges }` JSON å¹¶è¦†ç›–æ›´æ–° (Upsert)ã€‚

### 2.3 å‰ç«¯æ•°æ®åŒæ­¥ (Auto-Save)

  * **çŠ¶æ€ç®¡ç†:** ä½¿ç”¨ `ref` æˆ– Pinia å­˜å‚¨ `nodes` å’Œ `edges`ã€‚
  * **ç›‘å¬:** ç›‘å¬ Vue Flow çš„ `onNodesChange` å’Œ `onEdgesChange` äº‹ä»¶ã€‚
  * **é˜²æŠ– (Debounce):** ä½¿ç”¨ `lodash.debounce` (æ¯”å¦‚ 2000ms)ã€‚å½“ç”¨æˆ·åœæ­¢æ‹–æ‹½/ç¼–è¾‘ 2 ç§’åï¼Œè‡ªåŠ¨è§¦å‘ `POST /api/universe`ã€‚
  * **çŠ¶æ€åé¦ˆ:** ç•Œé¢å³ä¸‹è§’æ˜¾ç¤º "Saving..." -\> "Saved"ã€‚

-----

## Phase 3: å¤šåª’ä½“æ”¯æŒ (The Rich Content)

**ç›®æ ‡:** è®©èŠ‚ç‚¹æ”¯æŒå›¾ç‰‡ä¸Šä¼ ã€‚

### 3.1 Cloudinary é›†æˆ

  * **ç»„ä»¶:** åˆ›å»º `ImageUploader.vue`ã€‚
  * **é€»è¾‘:**
      * ä½¿ç”¨ HTML `<input type="file">` é€‰æ‹©å›¾ç‰‡ã€‚
      * è°ƒç”¨ Cloudinary Upload API (ä½¿ç”¨ä¹‹å‰é…ç½®çš„ Unsigned Preset)ã€‚
      * **å…³é”®:** ä¸è¦ç»è¿‡åç«¯ï¼Œå‰ç«¯ç›´æ¥ä¼ ã€‚
  * **å›è°ƒ:** ä¸Šä¼ æˆåŠŸåï¼Œè·å– `secure_url`ã€‚

### 3.2 èŠ‚ç‚¹æ›´æ–°é€»è¾‘

  * å½“ç”¨æˆ·åœ¨ `MoriNode` ä¸Šä¼ å›¾ç‰‡æˆåŠŸåï¼š
    1.  æ›´æ–°è¯¥ Node çš„ data (`node.data.image = url`)ã€‚
    2.  è§¦å‘ Vue Flow çš„æ›´æ–°æœºåˆ¶ã€‚
    3.  è§¦å‘ä¸Šé¢çš„ Auto-Save é€»è¾‘å­˜å…¥ MongoDBã€‚

-----

## Phase 4: äº¤ä»˜ä¸éƒ¨ç½² (Delivery)

**ç›®æ ‡:** ä¸Šçº¿ç»™æœ‹å‹çœ‹ã€‚

### 4.1 ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥

  * **Env Vars:** ç¡®ä¿ Render åå°é…ç½®äº† `MONGODB_URI`ã€‚
  * **Build:** ç¡®ä¿ Dockerfile çš„ `npm run build` èƒ½æ­£ç¡®æ‰“åŒ…æœ€æ–°çš„å‰ç«¯ä»£ç ã€‚

### 4.2 æ¼”ç¤ºæ•°æ® (Seed Data)

  * ç¼–å†™ä¸€ä¸ªè„šæœ¬æˆ–åœ¨æœ¬åœ°è¿è¡Œä¸€æ¬¡ï¼Œæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªæ¼‚äº®çš„â€œMori ä»‹ç»â€æ˜Ÿç³»ï¼ˆåŒ…å«å‡ ä¸ªè¯´æ˜èŠ‚ç‚¹å’Œå›¾ç‰‡ï¼‰ã€‚
  * è¿™å°±æ˜¯ç”¨æˆ·ç¬¬ä¸€æ¬¡æ‰“å¼€æ—¶çœ‹åˆ°çš„é»˜è®¤çŠ¶æ€ã€‚

-----

## âœ… ä¸‹ä¸€æ­¥è¡ŒåŠ¨å»ºè®®

ç°åœ¨çš„å·¥ç¨‹è·¯å¾„éå¸¸æ¸…æ™°ã€‚æˆ‘ä»¬åº”è¯¥ä» **Phase 1: å‰ç«¯ç”»å¸ƒæ ¸å¿ƒ** å¼€å§‹ã€‚

**è¯·å¤åˆ¶ä»¥ä¸‹ Prompt å‘é€ç»™æˆ‘ï¼ˆæˆ–ä»»ä½• AIï¼‰ï¼Œå¼€å§‹å†™ç¬¬ä¸€è¡Œæ ¸å¿ƒä»£ç ï¼š**

> â€œContext: æˆ‘æ­£åœ¨å¼€å‘ Moriï¼Œä¸€ä¸ªåŸºäº Vue 3 + Vue Flow çš„æ˜Ÿç³»é£æ ¼è„‘å›¾ã€‚
>
> Task: è¯·å¸®æˆ‘åˆå§‹åŒ– Vue Flow ç”»å¸ƒã€‚
> Requirements:
>
> 1.  åˆ›å»ºä¸€ä¸ª `MoriCanvas.vue` ç»„ä»¶ã€‚
> 2.  åˆå§‹åŒ–æ•°æ®ï¼šå±å¹•ä¸­å¿ƒæœ‰ä¸€ä¸ª ID ä¸º 'core' çš„èŠ‚ç‚¹ï¼ˆType: 'custom'ï¼‰ï¼Œå†…å®¹æ˜¯ 'Me'ã€‚
> 3.  å®ç°ä¸€ä¸ª 'Add Node' æŒ‰é’®ï¼Œç‚¹å‡»ååœ¨æ ¸å¿ƒå‘¨å›´éšæœºä½ç½®ç”Ÿæˆä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆä¸€æ¡è¿å‘æ ¸å¿ƒçš„ Edgeã€‚
> 4.  è¯·æä¾›å®Œæ•´çš„ Vue ç»„ä»¶ä»£ç ã€‚â€